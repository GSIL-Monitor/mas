<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.AlbumMysqlDao">

    <resultMap type="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.ItvLabelResource"
        id="itvLabelResourceMap">
        <result property="id" column="id" />
        <result property="labelId" column="label_id" />
        <result property="itvAlbumId" column="itv_album_id" />
        <result property="categoryId" column="categoryid" />
        <result property="isNew" column="isnew" />

        <result property="isTop" column="istop" />

        <result property="isAuto" column="isauto" />

        <result property="orderNum" column="ordernum" />

        <result property="status" column="status" />

        <result property="createTime" column="createtime" />

        <result property="updateTime" column="updatetime" />

        <result property="createdBy" column="createdby" />

        <result property="updatedBy" column="updatedby" />

        <result property="pic" column="pic" />

        <result property="videoInfoId" column="videoInfoId" />

        <result property="codeVersion" column="codeVersion" />

        <result property="resourceType" column="resourceType" />
        <result property="title" column="title" />
    </resultMap>

	<select id="getAlbumById" resultType="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.AlbumMysqlTable">
		select * from
		iptv.IPTV_ALBUM_INFO where id = #{id}
	</select>

    <select id="getAlbumListByIdList" resultType="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.AlbumMysqlTable">
        select * from
        iptv.IPTV_ALBUM_INFO where id in
        <foreach item="item" index="index" collection="list"
                 open="(" separator="," close=")">
            #{item}
        </foreach>
    </select>

    <select id="getAllChargeAlbumList" resultType="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.AlbumMysqlTable">
        select * from
        iptv.IPTV_ALBUM_INFO where deleted = 0 AND album_type = '180001' AND (
        <choose>
            <when test="payPlats !=null">
                <foreach collection="payPlats" item="item" index="index" separator="or" >INSTR(`pay_platform`, #{item}) >0 </foreach>
            </when>
            <otherwise>
               pay_platform != ''
            </otherwise>
        </choose>
        ) AND category != '1'
        limit #{start}, #{size}
    </select>

    <select id="getAlbumIdListUpdatedAfter" resultType="Long">
      <![CDATA[
        select id from
          iptv.IPTV_ALBUM_INFO 
            where update_time <= #{updateTime} 
              and create_time >= #{createTime} 
                order by create_time desc 
                  limit #{start}, #{end}
      ]]>
    </select>
    
    <select id="getAlbumIdListCreatedOrReleaseAfter" resultType="Long">
      <choose>
        <when test="createTime==null">
          <![CDATA[
            select id from 
              iptv.IPTV_ALBUM_INFO 
                order by create_time desc 
          ]]>
        </when>
        <otherwise>
          <![CDATA[
            select id from 
              iptv.IPTV_ALBUM_INFO 
                where create_time >= #{createTime} 
                  or ( release_date is not null and release_date >= #{createTime} ) 
                  or ( update_time is not null and update_time >= #{createTime} ) 
                  order by create_time desc 
          ]]>
        </otherwise>
      </choose>
    </select>
    
    <sql id="insertOrUpdateSearchAlbumCommonParameter">
        id=#{id},itv_album_id=#{itv_album_id},name_cn=#{name_cn},sub_title=#{sub_title},name_en=#{name_en},release_date=#{release_date},
        language=#{language},language_name=#{language_name},area=#{area},area_name=#{area_name},description=#{description},
        short_desc=#{short_desc},tag=#{tag},episode=#{episode},score=#{score},recomm_level=#{recomm_level},copyright_type=#{copyright_type},
        copyright_type_name=#{copyright_type_name},copyright_start=#{copyright_start},copyright_end=#{copyright_end},
        copyright_company=#{copyright_company},is_end=#{is_end},follownum=#{follownum},create_time=#{create_time},update_time=#{update_time},
        category=#{category},category_name=#{category_name},sub_category=#{sub_category},sub_category_name=#{sub_category_name},
        directory=#{directory},actor=#{actor},starring=#{starring},screen_writer=#{screen_writer},music_authors=#{music_authors},
        music_compose=#{music_compose},style=#{style},style_name=#{style_name},record_company=#{record_company},issue_company=#{issue_company},
        pic_collections=#{pic_collections},deleted=#{deleted},play_tv_name=#{play_tv_name},play_tv=#{play_tv},duration=#{duration},
        album_type=#{album_type},album_type_name=#{album_type_name},letv_release_date=#{letv_release_date},name_pinyin_abb=#{name_pinyin_abb},
        status=#{status},play_streams=#{play_streams},isyuanxian=#{isyuanxian},cntv=#{cntv},wasu=#{wasu},cibn=#{cibn},starring_play=#{starring_play},
        first_play_time=#{first_play_time},is_homemade=#{is_homemade},fit_age=#{fit_age},pushflag=#{pushflag},album_attr=#{album_attr}
    </sql>
    
      <sql id="insertOrUpdateAlbumCommonParameter">
        id=#{id},itv_album_id=#{itv_album_id},album_base_type=#{album_base_type},album_type=#{album_type},
        album_type_name=#{album_type_name},name_cn=#{name_cn},name_pinyin_abb=#{name_pinyin_abb},name_en=#{name_en},
        sub_title=#{sub_title},alias=#{alias},short_desc=#{short_desc},description=#{description},
        tag=#{tag},score=#{score},category=#{category},category_name=#{category_name},
        sub_category=#{sub_category},sub_category_name=#{sub_category_name},download_platform=#{download_platform},play_platform=#{play_platform},
        pay_platform=#{pay_platform},status=#{status},deleted=#{deleted},fid=#{fid},
        forder=#{forder},is_end=#{is_end},follownum=#{follownum},is_height=#{is_height},
        area=#{area},area_name=#{area_name},release_date=#{release_date},letv_release_date=#{letv_release_date},
        episode=#{episode},play_status=#{play_status},maker_company=#{maker_company},directory=#{directory},
        actor=#{actor},actor_play=#{actor_play},actor_desc=#{actor_desc},actor_play_pic=#{actor_play_pic},
        starring=#{starring},starring_play=#{starring_play},starring_play_pic=#{starring_play_pic},starring_desc=#{starring_desc},
        pic_collections=#{pic_collections},pic_original=#{pic_original},screen_writer=#{screen_writer},maker=#{maker},
        sports_type=#{sports_type},sports_type_name=#{sports_type_name},letv_make_style=#{letv_make_style},letv_make_style_name=#{letv_make_style_name},
        pop_style=#{pop_style},pop_style_name=#{pop_style_name},letv_produce_style=#{letv_produce_style},letv_produce_style_name=#{letv_produce_style_name},
        film_base_type=#{film_base_type},film_base_type_name=#{film_base_type_name},travel_theme=#{travel_theme},travel_theme_name=#{travel_theme_name},
        travel_type=#{travel_type},travel_type_name=#{travel_type_name},field_type=#{field_type},field_type_name=#{field_type_name},
        r_company=#{r_company},language=#{language},language_name=#{language_name},fit_age=#{fit_age},
        cast=#{cast},dub=#{dub},producer=#{producer},compere=#{compere},
        instructor=#{instructor},music_authors=#{music_authors},music_style=#{music_style},music_style_name=#{music_style_name},
        record_company=#{record_company},issue_company=#{issue_company},music_compose=#{music_compose},program_style=#{program_style},
        program_style_name=#{program_style_name},play_tv_name=#{play_tv_name},play_tv=#{play_tv},supervise=#{supervise},
        originator=#{originator},recreation_type=#{recreation_type},recreation_type_name=#{recreation_type_name},carfilm_type=#{carfilm_type},
        carfilm_type_name=#{carfilm_type_name},first_play_time=#{first_play_time},school=#{school},is_follow=#{is_follow},
        play_streams=#{play_streams},isyuanxian=#{isyuanxian},cntv=#{cntv},wasu=#{wasu},cibn=#{cibn},create_time=#{create_time},
        update_time=#{update_time},album_type_all=#{album_type_all},album_type_name_all=#{album_type_name_all},directory_all=#{directory_all},
        starring_all=#{starring_all},actor_all=#{actor_all},actor_play_all=#{actor_play_all},maker_all=#{maker_all},
        category_all=#{category_all},category_name_all=#{category_name_all},sub_category_all=#{sub_category_all},
        sub_category_name_all=#{sub_category_name_all},rcompany_all=#{rcompany_all},style=#{style},style_name=#{style_name},
        recomm_level=#{recomm_level},copyright_type=#{copyright_type},copyright_type_name=#{copyright_type_name},copyright_start=#{copyright_start},
        copyright_end=#{copyright_end},copyright_company=#{copyright_company},duration=#{duration},is_homemade=#{is_homemade},pushflag=#{pushflag},album_attr=#{album_attr},actor_id=#{actor_id},
        directory_id=#{directory_id}, starring_id=#{starring_id}, relationId=#{relationId}, relationAlbumId=#{relationAlbumId}, videoFollowTime=#{videoFollowTime}, varietyShow=#{varietyShow},
        auditHis=#{auditHis}, contentRatingId=#{contentRatingId}, nowEpisodes=#{nowEpisodes}, positive_play_streams=#{positive_play_streams}, tvFirstOnTime=#{tvFirstOnTime}, videoId=#{videoId}, 
        auditWasu=#{auditWasu},isDanmaku=#{isDanmaku},isPushChild=#{isPushChild},source_id=#{source_id}
    </sql>
    
    <select id="getIptvAlbumInfoIdsForSyncMedia" resultType="Long">
        select id from iptv.IPTV_ALBUM_INFO  order by id asc
    </select>
    
	<select id="getListByLabelIdForZT" resultMap="itvLabelResourceMap">
        select * from ITV_LABEL_ITVALBUM lv where lv.status = 1 and
        lv.label_id = #{labelId}
        <if test="categoryId != null and categoryId > 0">
            and lv.categoryid = #{categoryId}
        </if>
        order by lv.ordernum asc
        limit #{start},#{limit}
    </select>
    
    <select id="getCountByLabelIdForZT" resultType="Integer">
        select count(*) from ITV_LABEL_ITVALBUM lv where lv.status = 1 and
        lv.label_id = #{labelId}
        <if test="categoryId != null and categoryId > 0">
            and lv.categoryid = #{categoryId}
        </if>
    </select>
    
    <select id="getCountByLabelId" resultType="Integer">
		select count(*) from ITV_LABEL_ITVALBUM lv where lv.status = 1 and
		lv.label_id = #{labelId}
		<if test="categoryId != null and categoryId > 0">
			and lv.categoryid = #{categoryId}
		</if>
		<choose>
			<when test="broadcastId != null and broadcastId  > 0">
				and
				(lv.itv_album_id in (SELECT itv_album_id from
				IPTV_ALBUM_INFO where cntv=1)
				or lv.videoInfoId in (SELECT
				video_info_id from IPTV_VIDEO_INFO where
				cntv = 1) )
			</when>
			<otherwise>
				and
				(lv.itv_album_id in (SELECT itv_album_id from
				IPTV_ALBUM_INFO)
				or lv.videoInfoId in (SELECT video_info_id from
				IPTV_VIDEO_INFO) )
			</otherwise>
		</choose>
	</select>
	<select id="getListByLabelId" resultMap="itvLabelResourceMap">
		select * from ITV_LABEL_ITVALBUM lv where lv.status = 1 and
		lv.label_id = #{labelId}
		<if test="categoryId != null and categoryId > 0">
			and lv.categoryid = #{categoryId}
		</if>
		<choose>
			<when test="broadcastId != null and broadcastId  > 0">
				and
				(lv.itv_album_id in (SELECT itv_album_id from
				IPTV_ALBUM_INFO where cntv=1)
				or lv.videoInfoId in (SELECT
				video_info_id from IPTV_VIDEO_INFO where
				cntv = 1) )
			</when>
			<otherwise>
				and
				(lv.itv_album_id in (SELECT itv_album_id from
				IPTV_ALBUM_INFO)
				or lv.videoInfoId in (SELECT video_info_id from
				IPTV_VIDEO_INFO) )
			</otherwise>
		</choose>
		order by lv.ordernum asc
		limit #{start},#{limit}
	</select>
	
	<insert id="insertAlbumInfo" parameterType="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.AlbumMysqlTable">
		insert into iptv.IPTV_ALBUM_INFO set
		<include refid="insertOrUpdateAlbumCommonParameter" />
	</insert>
	
	<delete id="deleteAlbumInfoById">
		delete from iptv.IPTV_ALBUM_INFO where id = #{id}
	</delete>
	
	<update id="updateAlbumInfoById" parameterType="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.AlbumMysqlTable">
		update iptv.IPTV_ALBUM_INFO set
		<include refid="insertOrUpdateAlbumCommonParameter" />
		where id=#{id}
	</update>
	
	<select id="getSearchIptvAlbumInfoById" resultType="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.SearchIptvAlbumInfo">
		select * from
		search.SEARCH_IPTV_ALBUM_INFO where id = #{id}
	</select>
	
	<insert id="insertSearchIptvAlbumInfo" parameterType="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.SearchIptvAlbumInfo">
		insert into search.SEARCH_IPTV_ALBUM_INFO set
		<include refid="insertOrUpdateSearchAlbumCommonParameter" />
	</insert>
	
	<update id="updateSearchIptvAlbumInfoById" parameterType="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.SearchIptvAlbumInfo">
		update search.SEARCH_IPTV_ALBUM_INFO set
		<include refid="insertOrUpdateSearchAlbumCommonParameter" />
		where id=#{id}
	</update>
	
	<select id="listIptvAlbumInfoByLimit" resultType="com.letv.mas.caller.iptv.tvproxy.common.model.dao.db.table.AlbumMysqlTable">
		select * from
		iptv.IPTV_ALBUM_INFO where pushflag=1 limit #{start},#{limit}
	</select>
	
	<delete id="deleteSearchIptvAlbumInfoById">
		delete from search.SEARCH_IPTV_ALBUM_INFO where id =
		#{id}
	</delete>
	
	<select id="getIptvAlbumInfoIds" resultType="Long">
    	select id from iptv.IPTV_ALBUM_INFO where id not in(10000106,   10000113,   10000114,10000123,   10000124,   10000136,   10000248,   10000249,10000250,   10000275,   10000276,   10000277,   10000281,10000284,   10000286,   10000287,   10000289,   10000297,10000299,   10000313,   10000314,   10000315,   10000316,10000317,   10000318,   10000319,   10000334,   10000367,10000372,   10000379,   10000400,   10000408,   10000427,10000455,   10000481,   10073,10074,10076,10077,10115,10218,10221,10291,10292,10385,10386,10387,10388,10415,11247,11620,12300,13848,13852,14165,14361,14368,14578,14853,15106,16,   16807,16824,17558,17857,18011,18294,18483,18602,18708,18849,19179,19604,19605,19607,19609,19610,19617,19618,19619,19622,19624,19625,19626,19629,19650,19651,19652,19653,19654,19656,19658,19661,19665,19666,19667,19668,19669,19670,19671,19673,19674,19782,19791,19793,19795,19799,19801,19802,19805,19807,19809,19811,19813,19814,19816,19817,19820,19828,19830,19831,19832,19835,19836,19837,19838,19839,19841,19843,19849,19852,19853,19889,19890,19891,19894,19896,19911,19914,19918,19919,19922,19924,19929,19930,19931,19933,19934,19936,19937,19941,19942,19969,19995,20000,20031,20508,20509,20510,20681,20943,20966,21094,21177,21676,21870,21871,21872,21889,22002,22110,22218,22233,22305,22499,22865,22867,22899,23067,23071,23145,23174,23180,23185,23196,23199,23268,23283,23290,23326,23333,23336,23411,23448,23452,23456,23459,23462,23468,23533,23601,23683,23807,23907,23912,23964,23972,23979,24102,24244,24382,24406,24420,24432,24466,24471,24510,25003,25053,25185,25308,25402,25406,25436,25500,25507,25510,25511,25512,25543,25555,25608,25618,25635,25728,26417,26505,26559,26658,2666, 26661,26667,26669,26671,26674,26693,26699,26750,26819,26827,27004,27055,27080,27086,27119,27217,27236,27384,27385,27534,27537,27796,27904,27910,27914,28298,28411,28544,28575,28576,28580,28815,28821,29016,29020,29047,29050,29143,29144,29357,29889,30503,30520,30571,30626,30796,30856,30862,30918,31242,31852,31854,31855,31856,31858,31860,31862,31864,31866,31867,31871,31872,31873,31874,31875,31876,31877,31878,31879,31880,31882,31883,31885,31886,31888,31889,31893,31896,31897,31898,31899,31900,31901,31902,31903,31904,31905,31906,31907,31909,31910,31911,31912,31913,31914,31915,31917,31918,31947,31955,31957,31958,31980,31991,31992,31994,31995,31996,31997,31998,31999,32000,32001,32002,32003,32004,32005,32006,32007,32008,32010,32013,32014,32015,32019,32025,32029,32051,32052,32064,32077,32078,32081,32452,32454,32460,32682,33257,33259,33260,33261,33264,33266,33267,33268,33271,33453,33454,33455,33470,33480,33481,33482,33823,33824,33825,33946,34002,34036,34074,34157,34180,34181,34184,34185,34186,34220,34227,34230,34231,34232,34456,34484,34485,34486,34487,34491,34492,34497,34507,34512,34527,34661,34671,34673,34674,34678,34679,34680,34682,34683,34684,34685,34686,34687,34688,34689,34690,34691,34692,34698,34699,34725,34730,34738,34750,34808,34853,34857,34961,35159,35161,35165,35166,35170,35172,35174,35175,35176,35179,35180,35182,35183,35221,35222,35223,35225,35226,35250,35251,35252,35281,35480,35481,35483,35484,35758,35855,35856,35858,35859,35860,35863,35864,35865,35866,35867,35868,35869,35870,35871,3598, 35991,35995,36069,36073,36075,36077,36131,36197,36198,36228,36229,36230,36243,36509,36650,36764,36766,36767,36768,36769,36770,36771,36772,36773,36774,36776,36780,36781,36880,36881,36883,36884,36885,36886,36887,36888,36908,37073,37098,37100,37303,37304,37348,37404,37405,37406,37407,37409,37419,37444,37445,37446,37447,37449,37450,37451,37452,37454,37455,37458,37459,37467,37468,37469,37479,37481,37484,37492,37494,37495,37538,37542,37543,37666,37689,37702,37809,37873,37874,37875,37876,37877,37925,37932,37934,37937,37941,37981,38110,38247,38248,38249,38324,38325,38392,38393,38394,38403,38404,38493,38494,38507,38516,38706,38708,38731,38733,38799,38809,38817,38821,38825,38826,38827,38829,38830,38831,38833,38834,38835,38837,38839,38841,38842,38843,38845,38848,38850,38851,38853,38858,38859,38863,38872,38879,38899,38900,38902,38908,38910,38916,38917,38919,38921,38922,38924,38936,38937,38938,38939,38940,38941,38943,38958,38961,38963,38964,38967,38968,38969,38970,38971,38974,38975,38977,38978,38979,38981,38982,38983,38984,38986,38987,38989,38990,38995,38996,38997,39036,39037,39038,39039,39040,39041,39042,39043,39045,39048,39050,39054,39061,39080,39082,39083,39084,39086,39087,39088,39089,39092,39097,39101,39102,39104,39105,39109,39112,39113,39120,39127,39128,39131,39135,39137,39139,39142,39143,39144,39151,39154,39157,39165,39168,39170,39173,39174,39178,39218,39220,39221,39222,39223,39224,39225,39226,39228,39233,39235,39238,39250,39251,39255,39256,39257,39259,39260,39264,39267,39268,39270,39303,39305,39309,39310,39429,39466,39467,39468,39470,39471,39479,39480,39482,39510,39511,39512,39513,39514,39515,39564,39567,39574,39719,39851,39866,39871,39872,39925,39926,40143,40146,40147,40154,40155,40161,40162,40186,40187,40189,40190,40192,40193,40195,40196,40202,40203,40205,40206,40207,40208,40209,40210,40211,40212,40213,40214,40215,40216,40217,40218,40219,40262,40304,40314,40316,40318,40319,40323,40324,40333,40339,40346,40348,40360,40361,40368,40369,40381,40382,40405,40407,40408,40409,40476,40477,40494,40495,40498,40500,40546,40551,40767,40816,41029,41031,41033,41036,41038,41039,41042,41058,41061,41064,41065,41066,41078,41080,41081,41083,41088,41089,41092,41096,41131,41132,41141,41142,41143,41148,41150,41228,41238,41239,41241,41243,41247,41248,41250,41252,41254,41255,41260,41262,41266,41270,41279,41296,41314,41315,41316,41317,41364,41848,41849,41851,41853,41882,41884,41975,41976,41977,42002,42009,42096,42099,42176,42222,42223,42224,42225,42226,42227,42228,42452,42453,42494,42509,42518,42519,42561,42563,42609,42670,42675,42690,42691,42700,42729,42730,42732,42748,42749,42867,42868,42870,42871,42872,42873,42875,42876,42879,42880,42913,42916,42917,42938,42939,42940,42942,42945,42947,42951,42952,42957,42964,43049,43053,43056,43057,43070,43085,43155,43156,43199,43202,43205,43223,43240,43253,43254,43260,43278,43422,43423,43430,43477,43478,43479,43481,43483,43484,43485,43486,43487,43488,43490,43491,43492,43493,43494,43506,43507,43509,43520,43521,43522,43523,43524,43525,43526,43527,43717,43764,43825,43830,43890,43891,43892,43893,43986,43996,43997,44005,44006,44020,44021,44040,44077,44097,44266,44269,44300,44381,44383,44384,44385,44386,44387,44407,44438,44579,44594,44597,44599,44601,44603,44638,44697,44702,44703,44705,44706,44717,44757,44758,44761,44765,44941,44942,44944,44962,44974,44983,44988,45090,45092,45110,45114,45201,45202,45205,45211,45213,45273,45279,45280,45283,45287,45321,45335,45384,45413,45611,45612,45703,45729,45783,45793,45815,45816,45819,45831,45917,46007,46057,46074,46089,46102,46113,46153,46256,46258,46306,46410,46496,46497,46498,46500,46501,46502,46503,46517,46578,46582,46584,46587,46609,46706,46734,46789,46792,46805,46806,46807,46814,46815,46818,46825,46846,46850,46861,46873,46878,46879,46880,46881,46883,46894,46896,46897,46898,46899,46900,46910,46917,46919,46927,46929,46942,46945,46946,46975,46976,46977,47009,47066,47075,47079,47114,47157,47158,47160,47173,47182,47263,47285,47287,47293,47295,47303,47304,47305,47447,47483,47490,47491,47503,47505,47528,47530,47531,47532,47533,47535,47536,47537,47554,47556,47557,47583,47584,47585,47587,47590,47591,47606,47609,47889,47891,47892,47893,47894,47895,47896,47947,47948,48053,48059,48071,48072,48465,48470,48471,48473,48476,48479,48709,48721,48729,48734,48949,48954,48955,48959,48962,48994,49023,49024,49025,49029,49066,49067,49068,49069,49085,49127,49129,49163,49164,49165,49198,49201,49203,49226,49243,49244,49245,49275,49277,49278,49280,49286,49291,49295,49296,49303,49308,49311,4941, 49415,49450,49523,49529,49570,49617,49688,49790,49791,49802,49804,49805,49808,49809,49851,49853,49855,49856,49860,49928,49933,50024,50026,50027,50095,50208,50272,50273,50283,50284,50285,50288,50290,50291,50292,5030, 50319,50321,50360,50430,50463,50491,50492,50786,50796,50962,50988,50990,50993,50995,50996,51011,51696,51778,51792,51874,52099,52100,52111,52131,52177,52187,52447,52448,52461,52462,52467,52476,52477,52480,52510,52605,52646,52647,52675,52684,52693,52696,52700,52702,52714,52717,52718,52726,52732,52747,52749,52757,52767,52777,52787,5297,52976,53058,53061,53094,53095,53163,53181,53208,53219,53230,53232,5330, 53332,5334, 5338,5340, 5341, 53418,5342, 53425,53426,53428,53445,53466,53543,53714,53722,53731,53732,53874,53957,53959,53961,53964,53974,54022,54040,54070,54080,54104,54110,54126,5414, 54163,5417,54237,54241,54244,54253,54259,54260,54287,54292,54293,54303,5432, 5433, 5434, 54355,54381,54406,54413,54441,54504,54534,54561,54568,54580,54581,54583,54584,54611,54612,54623,54684,54686,54701,54714,54817,5494,5505, 5540, 5543, 5564, 5605,5608, 5609, 5611, 5612, 5613,5693, 5730, 5740, 5755, 5770,5830, 5874, 5895, 5939, 5941,6019, 6032, 6078, 6169, 6170,6171, 6172, 6173, 6175, 6176,6177, 6187, 6230, 6307, 6311,6344, 6376, 6540, 6542, 6562,6600, 6619, 6773, 6794, 6929,6941, 6942, 70263,70436,70519,70663,70665,70692,7071, 7074,70796,70882,70987,7099, 71071,71075,71167,71223,71224,7134,71362,71364,71407,71481,71482,71483,71573,71737,71739,71809,71817,71863,71866,71867,71873,71902,71903,71926,71992,71995,71996,71997,71998,72015,72031,72041,72042,72105,72109,7214,72155,72224,72231,7228, 72285,72292,72332,72374,72390,72392,72480,72500,72514,72515,72550,72551,72552,72630,7264, 72694,72818,72873,72875,72876,72878,72879,72887,72888,72889,7289,72890,72897,72899,72910,72912,72930,72932,72933,72934,72935,72943,72944,72945,72946,72948,72949,72953,72954,72955,72957,72958,72960,72961,72963,72967,72995,72996,73001,73003,73004,73005,73008,73010,73013,73014,73015,73017,73020,73021,73022,73024,73025,73026,73030,73031,73032,73033,73074,73075,73086,73087,73189,73192,73193,73194,73196,73197,73198,73201,73202,73203,73204,73207,73210,73212,73226,73233,73237,73238,73239,73240,73241,73242,73260,73261,73262,73263,73264,73268,73269,73270,73271,73272,73274,73275,73276,73283,73285,73286,73288,73289,73290,73293,73294,73295,73296,73319,73322,73333,73334,73336,73343,73346,73347,73381,73388,73389,73397,73399,73403,73445,73446,73447,73449,73450,73451,73452,73453,73468,73469,73470,73471,73472,73473,73474,73475,73476,73479,73481,73484,73485,7350, 7351, 7363, 73754,73773,73774,73775,73776,73778,73779,73813,73819,73826,73828,73862,73883,73884,7395, 7396,73976,73977,73978,73979,73987,7399, 74002,74010,74019,74020,74021,74119,74130,74131,74132,74169,74170,74171,74173,74175,74179,74195,74196,74197,74214,74218,74219,74220,74221,74234,74266,74285,74286,7429, 74296,74298,74301,7433, 74349,74350,74351,74359,74360,74361,74362,74363,74364,74365,74366,74367,74368,74372,74373,74374,74375,74376,74378,74396,74436,74437,74438,74440,74441,74442,74443,74444,74445,74448,74483,74562,74563,74565,74566,74572,74574,74575,74577,74578,74579,74580,7461, 74706,74710,74711,74713,74715,74716,74717,74718,74719,74720,74725,74726,74728,74730,74732,74733,74737,74741,74746,74747,74748,74750,74752,74753,74754,74755,74757,74758,74759,74760,74765,74766,74797,74805,74808,74809,74810,74811,74812,74813,74814,74815,74820,74822,74824,74832,74834,74914,74915,74916,74917,74918,74919,74921,74927,74928,74931,74932,74933,74934,74936,74938,74939,74942,74943,74944,74954,74955,74956,74958,74959,74961,74963,74964,74967,74969,74970,74971,74973,74974,74975,74976,74977,74978,74979,74985,74989,74990,74991,74992,74994,75009,75011,75012,75013,75014,75016,75023,75032,75035,75040,75043,75051,75052,75053,75055,75056,75058,75059,75060,75062,75063,75065,75066,75067,75069,75070,75071,75072,75078,75082,75083,75084,75085,75086,75087,75088,75089,75090,75091,75092,75093,75127,75128,75129,75131,75143,75145,75146,75175,75177,75187,75188,75189,75191,75192,75193,75209,75210,75211,75212,75214,75216,75241,75245,75246,75247,75248,75250,75251,75252,75253,75254,75256,75278,75284,75286,75288,75362,75364,75365,75367,75368,75370,75371,75372,75373,75375,75382,75383,75390,75418,75425,75426,75427,75428,75429,75430,75431,75432,75441,75442,75443,75444,75445,75446,75492,75493,75494,75495,75498,75499,75500,75501,75504,75505,75507,75508,75509,75510,75511,75512,75520,75521,75522,75523,75524,75525,75527,75528,75529,75531,75533,75534,7556, 75562,75563,75564,75566,75569,7557, 75570,75572,75574,75576,75578,7558, 75601,75602,75603,75604,75640,75641,75643,75644,75645,75647,75648,75649,75650,75651,75652,75655,75663,75664,75665,75668,75680,75681,75686,75687,75688,75689,75694,75753,75754,75755,75770,75771,75772,75773,75776,75777,75778,75779,75780,75781,75782,75783,75785,75787,75789,75790,75791,75792,75793,75794,75795,75797,75798,75799,75800,75805,75807,75808,75814,75815,75816,75817,75819,75821,75822,75837,75838,75839,75840,75841,75842,75843,75844,75845,75846,75847,75848,75849,75850,75851,75853,75854,75855,75856,75858,75859,75860,75861,75862,75863,75866,75867,75868,75869,75870,75871,75872,75873,75874,75875,75876,75878,75879,75880,75881,75882,75885,75886,75887,75888,75890,75891,75896,75897,75898,75906,75960,75964,75965,75996,75997,75999,76005,76010,76011,76012,76014,76016,76019,76021,76023,76024,76055,76056,76059,76061,76062,76063,76065,76067,76068,76069,76070,76071,76073,76075,76077,76079,76081,76082,76096,76127,76170,76256,76272,76278,76304,76344,76348,76353,76354,76355,76357,76359,76360,76361,76362,76363,76364,76365,76367,76368,76369,76371,76372,76373,76374,76375,76376,76377,76378,76379,76380,76383,76386,76387,76389,76391,76393,76395,76397,76398,76399,76403,76404,76406,76457,76485,76502,76511,76516,76522,76532,76533,76534,76535,76537,76553,76554,76555,76556,76557,76559,76560,76561,76562,76563,76564,76565,76566,76567,76568,76569,76570,76571,76576,76577,76578,76579,7658, 76580,76581,76582,76583,76584,76585,76586,76587,76588,76589,76590,76591,76592,76593,76594,76595,76596,76597,76598,76599,76600,76603,76610,76647,76702,76703,76708,76710,76711,76714,76716,76719,76723,76724,76727,76832,76833,76834,76835,76870,76885,76887,76895,76907,76908,76909,76910,76911,76912,76913,76915,76916,76917,76918,76919,76920,76921,76922,76923,76924,76925,76926,76929,76931,76932,76934,76936,76937,76938,76939,76940,76942,76943,76944,76946,76947,76951,76952,76955,76956,76957,76958,76959,76960,76961,76962,76963,76964,76965,76967,76968,76969,76970,76974,76976,76977,76980,76981,76982,76983,76984,76986,76987,76988,76989,76990,76991,76992,76993,76994,76995,76996,76997,76999,77000,77001,77002,77015,77018,77019,77020,77021,77022,77023,77025,77026,77027,77028,77029,77031,77032,77033,77034,77035,77036,77037,77039,77040,77043,77044,77045,77046,77047,77048,77049,7705, 77050,77051,77052,77054,77057,77058,77059,77060,77063,77064,77065,77067,77070,77071,77072,77075,77078,77079,77080,77081,77085,77087,77088,77090,77091,77092,77093,77096,77097,77098,77101,77103,77104,77106,77108,77109,77110,77111,77113,77114,77116,77177,77179,77180,77181,77198,77199,77200,77201,77202,77203,77204,77206,77207,77208,7723,77248,77257,77280,77297,77304,77305,77306,77307,77309,77311,77313,77316,77317,77318,77321,77322,77324,77325,77326,77330,77331,77332,77333,77334,77335,77336,77354,77355,77356,77357,77378,77400,77409,77436,77437,77441,77442,77472,77473,77475,77477,77479,77483,77484,77488,77489,77490,77491,77492,77493,77494,77495,77496,77497,77498,77499,77500,77501,77503,77507,77509,77547,77550,77551,77553,77554,77556,77557,77558,77559,77567,7759, 77593,77594,7760,77608,77609,77610,77612,77613,77614,77615,77617,77618,77620,77646,77647,77650,77657,77670,77681,77718,77719,77720,77728,77830,77838,77866,77888,77889,77946,77947,77951,77956,78024,78033,78036,78040,78041,78073,78078,78104,78150,78153,78156,78159,78160,78162,78177,78179,78218,78220,78226,78231,78232,78233,78236,78288,78300,78311,78313,78333,78361,78362,78364,78365,78381,78382,78384,78454,78456,78461,78462,78463,78464,78465,78466,78467,78545,78546,78547,78548,78549,78551,78554,78556,78557,78558,78570,78572,78573,78574,78655,7870, 7871,78717,78718,78723,78745,78746,78747,78762,78763,78764,78765,78822,78823,78936,78942,7902,79056,7907, 79101,79103,79111,79112,79113,79116,79118,7913,79172,79290,79291,79292,79293,79295,79296,79297,79298,79299,7930, 79303,79306,79307,79308,79309,79310,79316,79318,79319,79322,79323,79324,79325,79326,79357,79371,7949, 7950, 79572,79586,79663,79684,79761,79852,79995,79996,79998,79999,80000,80001,80002,80008,80017,80040,80099,80103,80254,80336,8037,8038, 80403,80404,8042, 80508,8051, 80558,80704,80751,80752,80753,8077, 80834,80835,80902,80914,8093, 80935,8095, 81045,81050,81111,81178,8118, 81269,81270,81271,81272,81275,81276,81278,81312,81313,81314,81315,81316,81322,81323,81379,81380,81399,8142, 81550,81567,81608,81609,81648,81679,81803,81817,81819,81821,81822,81832,81934,81967,81982,82041,82042,8207,82184,82187,82190,82192,82193,82194,82198,82200,82201,82202,82205,82206,82210,82211,82212,82214,82216,82245,82247,82248,82249,82250,82264,82279,82312,82321,82327,8254, 82679,82747,82916,82961,82966,82971,82980,82981,82989,82990,82992,82994,82997,82998,83008,83009,83010,83012,83031,83033,83035,83153,83156,83158,83159,83182,83204,83212,83238,83242,83253,83254,83255,83259,83267,83268,83276,83373,83417,8345, 83470,83471,83520,83521,83522,83535,83539,83540,83541,8356, 83563,8357,83601,83615,83656,83658,83659,83660,83661,83662,83663,83664,83665,83666,83668,83669,83670,83671,83673,83674,83677,83679,83680,83683,83684,83685,83687,83735,83736,83737,83739,83740,83741,83742,83743,83744,83745,83746,83748,83750,83751,83752,83753,83754,83755,83756,83757,83758,83759,83760,83761,83762,83765,83768,83771,83773,83776,8378, 83798,8380, 83806,8382,83848,8385, 84029,84036,84038,84040,84041,84042,84043,84044,84070,84074,84084,84134,84143,84163,84183,8419, 8420, 84238,84240,84261,84274,84282,84344,84357,84369,84370,84414,84422,84434,84555,84618,84619,84621,84712,84714,84715,84719,84720,84721,84722,84723,84724,84725,84726,84727,84728,84729,84731,84732,84733,84734,84741,84743,84745,84748,84750,84761,84762,84763,84764,84765,84766,84767,84769,84770,84772,84773,84913,84914,85001,85027,85039,8506,85073,85117,85252,85257,85263,85271,85287,8542, 8543, 8544,85459,85460,85461,85478,85479,85576,85914,86006,86026,86027,8605, 86081,86082,86271,86284,86328,86353,86355,86356,86394,86420,86448,86449,86450,86464,86521,86621,86636,86638,86653,86658,86750,86763,86804,86897,86928,87021,87038,87126,87127,87176,87223,87226,87227,87231,87232,87234,8724, 87268,87271,87287,87291,8730, 8734, 87370,87371,8738, 87389,87410,87413,8743, 87436,87440,87444,87445,87453,87457,87458,87475,87486,87490,87491,87492,87493,87494,87495,87502,87504,87508,87543,87561,87562,87563,87653,87655,87695,87763,87766,87779,8779,87792,87810,87814,87822,87835,87908,87915,87917,87942,87983,88012,88046,88057,88222,88288,88300,88320,88325,88335,88352,88354,88381,88385,8840, 88406,8841, 8842, 8845, 88601,88628,88655,88694,88697,88731,88757,88838,88839,88859,88862,88881,88943,88954,89006,89008,89011,89042,89048,89145,89264,89266,89269,89270,89351,89475,89482,89484,89486,89492,89541,89695,89732,89733,89734,89752,89774,89788,89802,89815,89817,89847,89848,89849,89866,89950,89957,89984,89986,90002,90004,90042,90053,90078,90174,90198,90212,90217,90255,90262,90302,90311,90327,90331,9034, 90345,90349,9035, 90359,9036, 9037, 90496,90497,90498,90559,90560,90590,90593,90597,90599,90600,90603,90629,90631,90638,90640,90641,90642,90650,90654,9066, 90669,9067, 90670,90680,90681,90683,90685,90687,90690,90694,90695,90696,90698,90699,90717,90718,90720,90721,90722,90723,90724,90725,90728,90734,90735,90736,90737,90738,90740,90741,90742,90744,9082, 9083, 90929,90947,90950,91067,91075,91147,91195,91338,91351,91359,91386,91418,91419,91436,91443,91457,91461,9151, 91525,9153, 91530,91553,91555,91556,91557,91568,91572,91576,91591,91593,91596,91613,91614,91615,91616,91617,91618,91619,91621,91624,91641,91644,91645,91646,91647,91665,91668,91669,91699,91701,91702,91704,91705,91706,91707,91714,91715,91716,91720,91721,91722,91723,91739,91740,91741,91743,91744,91745,91746,91747,91748,91749,91750,91752,91759,91761,91762,91764,91765,91768,91769,91770,91771,91773,91783,91803,91849,91850,91871,91878,91880,91884,91915,91924,9195, 9196, 9197,9198, 92003,92061,92083,92084,92106,92114,92118,92119,92121,92139,92145,92146,92147,92270,92296,92300,92305,9231, 92357,92362,92363,9237, 92370,92372,92373,9239, 92404,92406,92407,92423,92424,92427,92455,92477,92478,92479,92489,92499,92501,92502,92503,92505,92511,92514,92515,92517,92530,92538,92555,92557,92578,92579,92580,92583,92584,92586,92587,92596,92597,92598,92600,92603,9261, 92612,92618,92623,92626,92646,92697,92728,92729,9274, 92781,92783,9279, 92792,92818,92819,92828,92888,92905,92970,92975,92978,92999,93005,93036,93123,93137,93139,93170,93217,93218,93289,93298,93309,93310,93311,93330,93405,93406,93408,93411,93419,93420,93421,93423,93424,93425,93426,93427,93431,93441,93442,93443,93444,93446,93448,93451,93454,93456,93457,93458,93459,93461,93477,93478,93479,93480,93481,93486,93535,93560,93563,93577,93581,93613,93626,93630,93692,93693,93696,93697,9371,93767,93819,93820,93877,93908,93911,93935,93937,93959,93960,93961,93970,93971,93976,93979,93980,93981,93991,93992,93993,93995,94020,94036,94052,94060,94062,94073,94095,94129,94135,94164,94166,94212,9424, 94242,94244,94248,94291,94294,94296,94310,94320,94324,94338,94344,94347,94348,94361,94362,94387,94403,94413,94414,94435,94453,94483,94491,94511,94512,94566,94572,94579,94580,94585,94586,94587,94599,94615,94620,94621,94624,94628,94635,94645,94652,94655,94657,94658,94660,94669,94683,94684,94719,9475, 94751,94764,94803,94818,9483, 94854,9486, 94867,9487, 94884,94904,94913,9492, 94922,94923,94929,94952,94954,94961,94970,94973,9499, 95041,95069,95070,95095,95136,95137,95163,95169,95210,95213,95233,95273,95286,95354,95359,95426,95453,95488,95494,95519,95538,95592,95595,9561,9562, 9563, 9564, 95643,95644,95657,95660,95661,95662,95716,95717,95727,95767,95768,95769,95820,95836,95837,95847,95866,95881,95957,9605, 9606, 9607,9608, 96084,96086,96088,96114,96137,96139,96155,96163,96168,96179,96180,96182,96184,96186,96200,9621, 96230,96240,96251,96257,96277,96289,96303,96320,96332,96339,96348,96349,96356,9644, 9672, 9687, 9722, 9725,9726, 9746, 9852, 9857, 9858,9859, 9860, 9861, 9986, 9987,9988, 9989)
    </select>

    <select id="getAlbumId4DailyRefresh" resultType="Long">
        select id from iptv.IPTV_ALBUM_INFO where id > #{id}
        <if test="cids != null">
            and category in
            <foreach collection="cids" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        and album_type in (180001, 181031)
        order by id asc
        limit #{size}
    </select>
</mapper>